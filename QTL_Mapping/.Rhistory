library(simEd)
install.packages("qtl)")
install.packages("qtl")
source('~/sorghum_QTL/QTL_mapping/visualization.R')
source('~/sorghum_QTL/QTL_mapping/visualization.R')
sorghum_data <- read.cross(format="csv", file="data/mergedData.csv", na.strings="NA", genotype=c("AA", "BB"), alleles=c("A", "B"), crosstype="riself")
plot(leafCountAll)
plot.scantwo(leafCountAll)
summary(leafCountAll)
source('~/sorghum_QTL/QTL_mapping/visualization.R')
source('~/sorghum_QTL/QTL_mapping/visualization.R')
View(leafAngleQTL)
plot(leafAngleQTL)
plot((mqmgetmodel(leafAngleQTL))
)
plot(mqmgetmodel(leafAngleQTL))
plot(sorghum_data)
plot(leafCountAll)
plot(leafCountAll, ylab="LOD score")
plot(leafCountAll)
plot(leafAngleQTL, chr=c(1, 2))
library(qtl)
plot(leafAngleQTL, chr=c(1, 2))
??plot.scantwo
leafAngleQTL$class
class(leafAngleQTL)
class(leafCountAll)
class(leafCountAll) <- "scantwo"
plot(leafCountAll)
source('~/sorghum_QTL/QTL_mapping/visualization.R')
plot(leafCountAll)
source('~/sorghum_QTL/QTL_mapping/estimate_effects.R')
source('~/sorghum_QTL/QTL_mapping/estimate_effects.R')
summary(leafAngleQTL)
source('~/sorghum_QTL/QTL_mapping/estimate_effects.R')
source('~/sorghum_QTL/QTL_mapping/estimate_effects.R')
source('~/sorghum_QTL/QTL_mapping/estimate_effects.R')
summary(fitted)
source('~/sorghum_QTL/QTL_mapping/modelFitting/fit_models_0.05.R')
summary(stalkHeightQTL)
summary(stalkHeightModel)
help(fitqtl)
source('~/sorghum_QTL/QTL_mapping/modelFitting/fit_models_0.05.R')
summary(stalkHeightModel)
summary(leafCountModel)
summary(panicleExsertionModel)
help(refineqtl)
leafCountQTL <- refineqtl(sorghum_data, pheno.col=3, qtl=leafCountQTL)
leafCountModel <- fitqtl(sorghum_data, pheno.col=3, qtl=leafCountQTL, get.ests=TRUE)
summary(leafCountModel)
leafCountModel$ests
leafCountModel$ests$ests
rep("leafCount", 2)
leafCountModel$ests$ests
length(leafCountModel$ests$ests)
length(leafAngleModel$ests$ests)
names(leafAngleModel$ests$ests)
leafAngleModel$ests$ests
leafCounModel$ests$ests
leafCountModel$ests$ests
names(leafCountModel$ests$ests)
names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)]
sapply(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)])
help(sapply)
sapply(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], strsplit("@"))
sapply(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], strsplit(split="@"))
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")[,1]
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")[1]
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")[,]
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")[[1]]
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")[1:length(leafCountModel$ests$ests)-1][1]
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")[1:length(leafCountModel$ests$ests)][1]
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")[1:length(leafCountModel$ests$ests)]
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")[1:length(leafCountModel$ests$ests)[1]]
strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")
cbind(strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@"))
rbind(strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@"))
c(strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")
)
QTL_positions <- strsplit(names(leafCountModel$ests$ests)[2:length(leafCountModel$ests$ests)], "@")
length(QTL_positions)
QTL_positions[1]
test <- QTL_positions[1]
test[1]
test[[1]]
test
unlist(test)
unlist(test)[1]
getChrNums <- function(model){
chrNums <- vector(mode="numeric")
QTL_positions <- strsplit(names(model$ests$ests)[2:length(model$ests$ests)], "@")
for(i in 1:length(QTL_positions)){
QTL <- QTL_positions[i]
chrNum <- as.numeric(unlist(QTL)[1])
chrNums <- c(chrNums, chrNum)
}
}
getChrNums(leafCountModel)
getChrNums <- function(model){
chrNums <- vector(mode="numeric")
QTL_positions <- strsplit(names(model$ests$ests)[2:length(model$ests$ests)], "@")
for(i in 1:length(QTL_positions)){
QTL <- QTL_positions[i]
chrNum <- as.numeric(unlist(QTL)[1])
chrNums <- c(chrNums, chrNum)
}
return(chrNums)
}
getChrNums(leafCountModel)
summary(leafCountModel)
leafCountModel$result.full
leafCountModel$result.drop
source('~/sorghum_QTL/QTL_mapping/modelFitting/fit_models_0.05.R')
warnings()
help(jittermap)
source('~/sorghum_QTL/QTL_mapping/modelFitting/fit_models_0.05.R')
source('~/sorghum_QTL/QTL_mapping/modelFitting/fit_models_0.05.R')
